1.1 create table kreatura like wikingowie.kreatura;
insert into kreatura select * from wikingowie.kreatura;

create table uczestnicy like wikingowie.uczestnicy;
insert into uczestnicy (id_wyprawy,id_uczestnika) select * from wikingowie.uczestnicy;

create table etapy_wyprawy like wikingowie.etapy_wyprawy;
insert into etapy_wyprawy select * from wikingowie.etapy_wyprawy;

create table sektor like wikingowie.sektor;
insert into sektor select * from wikingowie.sektor;

create table wyprawa like wikingowie.wyprawa;
insert into wyprawa select * from wikingowie.wyprawa;

1.2
select nazwa from kreatura left join uczestnicy on idKreatury=id_uczestnika where id_uczestnika is null;

1.3
select wyprawa.nazwa, SUM(kreatura.waga) from wyprawa inner join uczestnicy on wyprawa.id_wyprawy=uczestnicy.id_wyprawy inner join kreatura on uczestnicy.id_uczestnika=kreatura.idKreatury group by wyprawa.nazwa;

2.1

select wyprawa.nazwa, SUM(uczestnicy.id_uczestnika), GROUP_CONCAT(kreatura.nazwa) from wyprawa inner join uczestnicy on wyprawa.id_wyprawy=uczestnicy.id_wyprawy inner join kreatura on uczestnicy.id_uczestnika=kreatura.idKreatury group by wyprawa.nazwa;

2.2
select kolejnosc, sektor, kreatura.nazwa from etapy_wyprawy inner join wyprawa on etapy_wyprawy.idWyprawy=wyprawa.id_wyprawy inner join kreatura on wyprawa.kierownik=kreatura.idKreatury group by wyprawa.data_rozpoczecia, kolejnosc,sektor,nazwa;

3.1

select sektor,IFNULL(COUNT(sektor),0) as ile from etapy_wyprawy group by sektor;

3.2
select kreatura.nazwa, case when id_uczestnika>0 then 'bral udzialu w wyprawie' else 'nie bral udzial w wyprawie' end as udzial from uczestnicy right join kreatura on uczestnicy.id_uczestnika=kreatura.idKreatury;

4.1
select wyprawa.nazwa as nazwa,SUM(LENGTH(dziennik)) as dlugosc from etapy_wyprawy inner join wyprawa on wyprawa.id_wyprawy=etapy_wyprawy.idwyprawy group by nazwa having dlugosc>400;

4.2
select wyprawa.nazwa as nazwa,SUM(wikingowie.zasob.waga*wikingowie.ekwipunek.ilosc)/COUNT(uczestnicy.id_uczestnika) as waga from wyprawa inner join uczestnicy on wyprawa.id_wyprawy=uczestnicy.id_wyprawy inner join wikingowie.ekwipunek on uczestnicy.id_uczestnika=wikingowie.ekwipunek.idKreatury inner join wikingowie.zasob on wikingowie.ekwipunek.idZasobu=wikingowie.zasob.idZasobu group by nazwa;

5.1
select kreatura.nazwa as nazwa, DATEDIFF(kreatura.dataUr,'2021/12/22')*(-1) as datediff from kreatura inner join uczestnicy on kreatura.idKreatury=uczestnicy.id_uczestnika inner join wyprawa on uczestnicy.id_wyprawy=wyprawa.id_wyprawy inner join etapy_wyprawy on wyprawa.id_wyprawy=etapy_wyprawy.idWyprawy where etapy_wyprawy.sektor=7 group by nazwa,datediff;




